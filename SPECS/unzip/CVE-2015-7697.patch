diff -rup a/extract.c b/extract.c
--- a/extract.c	2009-03-13 18:32:52.000000000 -0700
+++ b/extract.c	2016-11-30 13:23:26.163704000 -0800
@@ -2701,6 +2710,12 @@ __GDEF
     int repeated_buf_err;
     bz_stream bstrm;
 
+    if (G.incnt <= 0 && G.csize <= 0L) {
+        /* avoid an infinite loop */
+        Trace((stderr, "UZbunzip2() got empty input\n"));
+        return 2;
+    }
+
 #if (defined(DLL) && !defined(NO_SLIDE_REDIR))
     if (G.redirect_slide)
         wsize = G.redirect_size, redirSlide = G.redirect_buffer;
